---
title: Influence of National Resources on Country Conflict
subtitle: Report
execute:
  echo: true
---

```{r}
#| label: load-pkgs
#| message: false
#| echo: false
library(tidyverse)
library(readxl)
library(countrycode) 
library(tidymodels)
library(openintro)
library(ggcorrplot)
library(broom)
library(kableExtra)

#main dataset abt resources

country_resource <- read_csv("data/NMC.csv")

#main dataset abt conflict

country_conflict <- read_csv("data/Conflict.csv")

```

AT THE END --\> set echo to false to not display the code cells ; only plots, words, and messages; cite gpt in code cells\
DOI citations or manually write refernces and citations \> not a requirement

This study examines the relationship between a country's national material capabilities — such as military expenditures, personnel, and iron — and its frequency engaging in conflict.
By analyzing data from the Correlates of War project, which tracks national capabilities and militarized interstate disputes, this research aims to identify whether increases in these capabilities correlate with higher frequencies of interstate conflict.
The findings seek to enhance our understanding of how shifts in state power influence international stability and conflict dynamics.

## Introduction and data

Our research question is as follows: how do changes in national material capabilities influence the frequency of a country's conflicts, focusing on the continent of Asia?
We hypothesize that countries with higher military expenditures and personnel are more likely to participate in armed conflicts.
The primary motivation for this research is to explore the relationship between national material capabilities and a country’s likelihood of being involved in conflicts.
Understanding how changes in a nation’s military capabilities — such as military expenditures and natural resources like iron — affect its involvement in international disputes is important for assessing political stability.

This research aligns with a broader theme of examining how data can explain political dynamics, provide insights into state behavior, and potentially help predict future conflicts.
In analyzing the intersection of politics and data, this study aims to tell a story about how power, in its different forms, shapes international relations.

The data used in this analysis comes from the Correlates of War (COW) project, which is widely used by political scientists.
This project consists of two datasets that apply to our research:

**National Material Capabilities** (Dataset 1): This dataset includes data on military power indicators such as military expenditures, military personnel, energy consumption, and total population for various countries.
The data is collected annually, providing a comprehensive look at the material capabilities of each nation over time.

**Militarized Interstate Disputes** (Dataset 2): This dataset records instances where states threaten, display, or use force against one another.
The data includes details such as the start and end dates of conflicts, number of combatants, casualties, and the outcomes of these disputes.
This dataset spans from 1816 to 2014 and provides insight into the frequency and intensity of conflicts between countries.

@tbl-dict provides an overview of relevant variables used in this analysis

```{r}
#| label: tbl-dict
#| echo: false
#| tbl-cap: "Excerpt of Data Dictionary"


variable_info <- tibble::tribble(
  ~Variable,      ~Definition,                                                                 ~Type,
  "country",      "Nation of observation",                         "categorical",
  "continent",    "Geographic area of the country (e.g., Asia)",                 "categorical",
  "count",        "Number of incidents of conflict",                    "numerical",
  "milex",        "Military expenditures in local currency(?) (in thousands)",      "numerical",
  "irst",         "Iron and Steel production levels in metric tons",             "numerical"
)

variable_info |>
kable()
```


## Methodology

Our project explored the relationship between military conflicts and various factors, including military expenditure, personnel, iron and steel production, and national capabilities.
Given the extensive dataset, which covered numerous countries, we initially faced challenges regarding clarity.
To streamline our analysis, we narrowed the scope to Asia, which emerged as the continent with the highest conflict frequency during our initial exploration.

In preparing the data, we addressed several challenges.
Variables irrelevant to our analysis were removed, and we were forced to correct unique country codes that didn’t align with standard naming conventions.
These codes were manually mapped to their respective countries, and we classified nations by continent, allowing us to focus solely on Asia.

Using this cleaned dataframe, we created visualizations to identify patterns in conflict frequency, iron production, and military strength metrics.
For example, we examined the periods with the highest levels of conflict and iron production and determined which countries contributed most to these metrics.
Early visualizations were cluttered due to the large number of countries, so we filtered the data to focus on the top 15 countries in terms of conflict frequency and iron production to improve clarity.
We also investigated correlations between national capabilities, such as military expenditure and conflict frequency, to identify potential predictors.
To assess the impact of these variables, we used regression modeling, with predictor variables.

For our analysis, we utilized several key R libraries to streamline data manipulation, modeling, and visualization.
The tidyverse suite was useful in providing tools for filtering and summarizing data and ggplot for crafting visualizations.
We used readxl to import Excel datasets into R.
The countrycode package helped map country codes from the dataset to their corresponding country names, helping us to group data by continent and eventually determine the focus on Asian countries.
For modeling and diagnostics, we relied on tidymodels for regression analysis.

Combining data preparation, visualization, statistical analysis, and modeling, we found meaningful trends and relationships that highlight how national capabilities influence military conflicts different countries in Asia.
This comprehensive approach allowed us to derive insights into the multifaceted drivers of geopolitics.

## Results

This is where you will discuss your overall finding and describe the key results from your analysis.
The goal is not to interpret every single element of an output shown, but instead to address the research questions, using the interpretations to support your conclusions.
Focus on the variables that help you answer the research question and that provide relevant context for the reader.

## Discussion

In this section you’ll include a summary of what you have learned about your research question along with statistical arguments supporting your conclusions.
In addition, discuss the limitations of your analysis and provide suggestions on ways the analysis could be improved.
Any potential issues pertaining to the reliability and validity of your data and appropriateness of the statistical analysis should also be discussed here.
Lastly, this section will include ideas for future work.

# Data Exploration

## Cleaning Data

```{r}
#| label: taking-out-unnecessary-variables
#| echo: false

country_resource <- country_resource |>
  select(-ccode, -version)

country_conflict <- country_conflict |>
  select(-ccode, -version)
```

```{r}
#| label: join-datasets
#| echo: false
country_join <- country_conflict |>
  full_join(country_resource, by = join_by(
      stabb == stateabb, 
      styear == year
    )
  )

number_of_disputes_df <- country_join |>
  group_by(stabb, styear) |>
  summarize(count = n(), .groups = "drop")


```

```{r}
#| label: filter-dataset
#| echo: false
country_join_edit <- country_join |>
  left_join(number_of_disputes_df, by = c("stabb" = "stabb", "styear" = "styear"))

country_join_edit <- country_join |>
  left_join(number_of_disputes_df, by = c("stabb" = "stabb", "styear" = "styear"))

country_join_shorter <- country_join_edit |>
  select(stabb, styear, count, milex, milper, irst, cinc) |>
  distinct() |>
  filter(styear>1950)
```

# Adding Continents

After a series of attempting visualizations we found that there were too many countries to properly find a relationship as such we determined that in order to consolidate our data the best move forward would be to group by continents.

```{r}
#| label: continents 
#| message: false
#| warning: false
#| echo: false

# Manually addded countried from the COW dataset, COW codes do not match universal country codes so there were many NAs using the country code package to use the continents 

# cow code to country name --> to actual ISO code --> continents 

#stabb_values <- country_join_edit[["stabb"]] isolating COW code
#unique_stabb_values <- unique(stabb_values) removing duplicates; 219 countries unique 



CountryName <- data.frame(
  COWn = c("ZIM", "ZAN", "ZAM", "YUG", "YPR", "YEM", "YAR", "WSM", "WRT", "VEN",
           "VAN", "UZB", "USA", "URU", "UKR", "UKG", "UGA", "UAE", "TUV", "TUS",
           "TUR", "TUN", "TRI", "TON", "TOG", "TKM", "THI", "TAZ", "TAW", "TAJ", 
           "SYR", "SWZ", "SWD", "SWA", "SVG", "SUR", "SUD", "STP", "SSD", "SRI", 
           "SPN", "SOM", "SOL", "SNM", "SLV", "SLU", "SLO", "SKN", "SIN", "SIE", 
           "SIC", "SEY", "SEN", "SAX", "SAU", "SAL", "SAF", "RWA", "RVN", "RUS", 
           "ROM", "ROK", "QAT", "PRK", "POR", "POL", "PNG", "PMA", "PHI", "PER", 
           "PAR", "PAP", "PAN", "PAL", "PAK", "OMA", "NTH", "NOR", "NIR", "NIG", 
           "NIC", "NEW", "NEP", "NAU", "NAM", "MZM", "MYA", "MSI", "MOR", "MON", 
           "MOD", "MNG", "MNC", "MLT", "MLI", "MLD", "MEX", "MEC", "MAW", "MAS", 
           "MAL", "MAG", "MAD", "MAC", "MAA", "LUX", "LIT", "LIE", "LIB", "LES", 
           "LEB", "LBR", "LAT", "LAO", "KZK", "KYR", "KUW", "KOS", "KOR", "KIR", 
           "KEN", "JPN", "JOR", "JAM", "ITA", "ISR", "IRQ", "IRN", "IRE", "INS", 
           "IND", "ICE", "HUN", "HSG", "HSE", "HON", "HKG", "HAN", "HAI", "GUY", 
           "GUI", "GUA", "GRN", "GRG", "GRC", "GNB", "GMY", "GHA", "GFR", "GDR",
           "GAM", "GAB", "FSM", "FRN", "FIN", "FIJ", "EU", "ETM", "ETH", "EST", 
           "ERI", "EQG", "EGY", "ECU", "DRV", "DRC", "DOM", "DMA", "DJI", "DEN", 
           "CZR", "CZE", "CYP", "CUB", "CRO", "COS", "CON", "COM", "COL", 
           "CHN", "CHL", "CHA", "CEN", "CDI", "CAP", "CAO", "CAN", "CAM", 
           "BUL", "BUI", "BRU", "BRA", "BOT", "BOS", "BOL", "BNG", "BLZ", "BLR",
           "BHU", "BHM", "BFO", "BEN", "BEL", "BAV", "BAR", "BAH", "BAD", "AZE", 
           "AUS", "AUL", "AUH", "ARM", "ARG", "ANG", "AND", 
           "ALG", "ALB", "AFG"),
  
  
  Country = c("Zimbabwe", "Zanzibar", "Zambia", "Yugoslavia/Serbia",
              "Yemen People's Republic", "Yemen", "Yemen Arab Republic", 
              "Samoa", "Wuerttemburg", "Venezuela", "Vanuatu", "Uzbekistan", 
              "United States of America", "Uruguay", "Ukraine", 
              "United Kingdom", "Uganda", "United Arab Emirates", "Tuvalu", 
              "Tuscany", "Turkey", "Tunisia", "Trinidad and Tobago", "Tonga", 
              "Togo", "Turkmenistan", "Thailand", "Tanzania", "Taiwan",
              "Tajikistan", "Syria", "Switzerland", "Sweden", "Swaziland", 
              "St. Vincent and the Grenadines", "Suriname", "Sudan",
              "Sao Tome and Principe", "South Sudan", "Sri Lanka", "Spain", 
              "Somalia", "Solomon Islands", "San Marino", "Slovenia", 
              "St. Lucia", "Slovakia", "St. Kitts and Nevis", "Singapore", 
              "Sierra Leone", "Two Sicilies", "Seychelles", "Senegal", 
              "Saxony", "Saudi Arabia", "El Salvador", "South Africa",
              "Rwanda", "Republic of Vietnam", "Russia", "Romania", 
              "South Korea", "Qatar", "North Korea", "Portugal", "Poland", 
              "Papua New Guinea", "Parma", "Philippines", "Peru", "Paraguay",
              "Papal States", "Panama", "Palau", "Pakistan", "Oman", 
              "Netherlands", "Norway", "Niger", "Nigeria", "Nicaragua", 
              "New Zealand", "Nepal", "Nauru", "Namibia", "Mozambique",
              "Myanmar", "Marshall Islands", "Morocco", "Mongolia", "Modena", 
              "Montenegro", "Monaco", "Malta", "Mali", "Moldova", 
              "Mexico", "Mecklenburg Schwerin", "Malawi", "Mauritius", 
              "Malaysia", "Madagascar", "Maldives", "Macedonia", "Mauritania", 
              "Luxembourg", "Lithuania", "Liechtenstein", "Libya", "Lesotho",
              "Lebanon", "Liberia", "Latvia", "Laos", "Kazakhstan", 
              "Kyrgyzstan", "Kuwait", "Kosovo", "Korea", "Kiribati", 
              "Kenya", "Japan", "Jordan", "Jamaica", "Italy", "Israel", "Iraq",
              "Iran", "Ireland", "Indonesia", "India", "Iceland", "Hungary",
              "Hesse Grand Ducal", "Hesse Electoral", "Honduras", "Hong Kong", 
              "Hanover", "Haiti", "Guyana", "Guinea", "Guatemala", "Grenada", 
              "Georgia", "Greece", "Guinea-Bissau", "Germany", "Ghana", 
              "German Federal Republic", "German Democratic Republic", 
              "Gambia", "Gabon", "Federated States of Micronesia", "France", 
              "Finland", "Fiji", "European Community/Union", "East Timor",
              "Ethiopia", "Estonia", "Eritrea", "Equatorial Guinea", 
              "Egypt", "Ecuador", "Vietnam", "Democratic Republic of the Congo",
              "Dominican Republic", "Dominica", "Djibouti", "Denmark", 
              "Czech Republic", "Czechoslovakia", "Cyprus", "Cuba", 
              "Croatia", "Costa Rica", "Congo", "Comoros", "Colombia", "China",
              "Chile", "Chad", "Central African Republic", "Ivory Coast", 
              "Cape Verde", "Cameroon", "Canada", "Cambodia", "Bulgaria", 
              "Burundi", "Brunei", "Brazil", "Botswana", 
              "Bosnia and Herzegovina", "Bolivia", "Bangladesh", "Belize", 
              "Belarus", "Bhutan", "Bahamas", "Burkina Faso", "Benin", 
              "Belgium", "Bavaria", "Barbados", "Bahrain", "Baden",
              "Azerbaijan", "Austria", "Australia", "Austria-Hungary", 
              "Armenia", "Argentina", "Angola", "Andorra", "Algeria", 
              "Albania", "Afghanistan")
)

country_join_countrynames <- country_join_shorter |>
  left_join(CountryName, by = c("stabb" = "COWn")) 


# country column to get the ISO codes and continents
country_join_continents <- country_join_countrynames |>
  mutate(
    # join for country code conversion
    Country_code = countrycode(Country, "country.name", "iso3c"),
    # convert the ISO country code to continent
    Continent = countrycode(Country_code, "iso3c", "continent")
  ) |>
  filter(!is.na(Country)) |>
  filter(!is.na(Continent))
country_join_continents


```


# Which Continent has the Highest Propensity for Conflict?

In order to narrow our search for proper analyses we decided to focus on the continent with the highest propensity for conflict. @fig-high-prop-conflict shows that the continent with the highest propensity for conflict is Asia.

```{r}
#| label: fig-high-prop-conflict 
#| fig-cap: "Continent with the Highest Propensity for Conflict"
#| message: false
#| warning: false
#| echo: false

conflict_by_continent <- country_join_continents |>
  group_by(Continent) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  arrange(desc(total_conflict))


conflict_by_continent |>
  ggplot(aes(x = reorder(Continent, -total_conflict), y = total_conflict, fill = Continent)) +
  geom_col() +
  labs(
    title = "Total Conflict Incidents by Continent",
    x = "Continent",
    y = "Total Conflict Incidents",
    fill = "Continent"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Blues") 
```

We were interested in what periods were their heightened levels of both conflict and military capabilities, focusing on Iron.  shows that they both increase around the same time indicating that there could be a potential relationship and its a worthy quesiton to pursue. 

```{r}
#| label: fig-period-conflicts
#| layout-ncol: 2
#| fig-cap: 
#|   - "Trends in Conflict Incidents in Asia"
#|   - "Trends in Iron and steel production"
#| message: false
#| echo: false
#| warning: false


#fliter by asia 
asia <- country_join_continents |>
  filter(Continent == "Asia")


asia |>
  group_by(styear) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  ggplot(aes(x = styear, y = total_conflict)) +
  geom_line() +
  labs(
    title = "Trends in Conflict Incidents in Asia",
    x = "Year",
    y = "Total Conflict Incidents"
  ) +
  theme_minimal()


#fliter by asia 
asia <- country_join_continents |>
  filter(Continent == "Asia")

asia <- asia |>
  group_by(Country) |>
  mutate(
    mean_milex = mean(milex),
    mean_irst = mean(irst)
  )
# Confict and Iron production start around the same years.

asia |>
  group_by(styear) |>
  summarize(total_iron_production = sum(irst, na.rm = TRUE)) |>
  ggplot(aes(x = styear, y = total_iron_production)) +
  geom_line() +
  labs(
    title = "Trends in Iron and steel production (thousands of tons) in Asia",
    x = "Year",
    y = "Total Conflict Incidents around the same years as conflict"
  ) +
  theme_minimal()


```

# Methodology Exploration focusing on Asian Countries

#### Correlation between National Material Capabilities and Total Incident Counts

This matrix provides a foundation understanding of how key material capabilities such as military expenditure, personnel, and iron production are related to conflict frequency. This graph establishes whether material capabilities are significantly correlated with conflict frequency. This is done in order to justify the variables selected for deeper analyses, showing which ones have potentially stronger predictive power. shows that military expenditure and iron production has the highest correlation among the variables. 

```{r}
#| label: fig-correlation-matrix 
#| fig-cap: "Correlation Matrix"
#| message: false
#| warning: false
#| echo: false


#milex: Military expenditure.
#milper: Military personnel
#irst: Iron and Steel production
#cinc: Composite Index of National Capability.
#count: Frequency of conflicts.

asia <- asia |>
  mutate(count = as.numeric(count)) |>
  filter(!is.na(count)) |>
  ungroup()

#asia |>
 # select(milex, milper, irst, cinc, count) |>
  #cor(use = "complete.obs")


selected_vars <- asia |>
  select(count, milex, milper, irst, cinc)


cor_matrix <- cor(selected_vars, use = "pairwise.complete.obs")

cor_matrix |>
  knitr::kable() |>
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"))
ggcorrplot(cor_matrix, 
           method = "circle", 
           type = "lower", 
           lab = TRUE, 
           title = "Correlation of Material Capabilities and Conflict Frequency")

# Hypothesis Testing: Correlation significance
# cor_test_results <- map_df(
#   c("milex", "milper", "irst", "cinc"),
#   ~ tidy(cor.test(asia_15$count, asia_15[[.x]], use = "pairwise.complete.obs")),
#   .id = "variable"
# )

# cor_test_results
 

#Source: Chatgpt Q:"How to visualize correlation between different variables?"
```

### Correlation specifically between Total Incident Counts and Material Capabilities
@tbl-cor-table further supports the matrix findings. 
```{r}
#| label: tbl-cor-table
#| echo: false
#| tbl-cap: "Table Demonstrating Correlation between Total Incident Counts and Material Capabilities"

asia_cor_table <- tibble(
  `Military Capability` = c("Military Expenditures (thousands)", "Military Personnel (thousands)", "Iron and Steel Production (thousands of tons)"),
  `Correlation To Incident Count` = c(cor(asia$count, asia$milex), cor(asia$count, asia$milper), cor(asia$count, asia$irst))
)

asia_cor_table |>
  knitr::kable() |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

# Visualizing Incident Count and Military Capablities in Asia 
To identify the relationship between conflict frequency and military capabilities we decided to do a series of visualizations using scatter plots in order to uncovering patterns, clusters, and outliers. Focusing on the Military Expenditures and Iron production as they had the highest correlation within the set. 

a\.
@fig-military-expenditure-asia shows ***

```{r}
#| label: fig-military-expenditure-asia 
#| fig-cap: "Total Incident Count vs. Military Expenditures"
#| message: false
#| warning: false
#| echo: false

asia |>
  ggplot(aes(x = milex, y = count)) + 
  geom_point() + 
  geom_smooth(method = "lm") + 
  labs(
    title = "Total Incident Count vs. Military Expenditures",
    subtitle = "In Asian Countries from 1951 to 2016",
    x = "Military Expenditures (thousands)", 
    y = "Total Incident Count"
  ) + 
  theme_minimal()
```

b\.

@fig-iron-production-asia  shows *** 

```{r}
#| label: fig-iron-production-asia 
#| fig-cap: "Total Incident Count vs. Iron and Steel Production" 
#| message: false
#| warning: false
#| echo: false

asia |>
  ggplot(aes(x = irst, y = count)) + 
  geom_point() + 
  geom_smooth(method = "lm") + 
  labs(
    title = "Total Incident Count vs. Iron and Steel Production",
    subtitle = "In Asian Countries from 1951 to 2016",
    x = "Iron and Steel Production (thousands of tons)", 
    y = "Total Incident Count"
  )
```

## Classifying Asian Countries by Military Expenditures and Iron + Steel Production

We decided to highlight Key Dimensions of Military Power, classifying countries along these dimensions in order to help distinguish between those with higher or lower relative capacities for military action.

```{r}
#| label: mutate-data 
#| echo: false
asia <- asia |> 
  mutate(
    milex_class = case_when(
      milex < median(milex, na.rm = TRUE) ~ "low",
      .default = "high"
    ),
    
    irst_class = case_when(
      irst <= median(irst, na.rm = TRUE) ~ "low",
      .default = "high"
  )
)
```

### Visualization for Military Expenditure

By grouping countries into "high" and "low" military expenditure classes (relative to the median), the visualization explores whether military spending is associated with the frequency of incidents. Using a histogram to properly demonstrate how spending levels relate to incident distribution. 

In order to determine: 

Are countries with higher spending involved in more conflicts (offensive posture)?

Are countries with lower spending involved in fewer conflicts (lack of resources or deterrence by other nations)?

@fig-visual-milex-class demonstrates that *** connection to hypothesis 

```{r}
#| label: fig-visual-milex-class
#| echo: false
#| fig-cap: "Distribution of conflicts for countries with different military spending levels."

asia |>
  ggplot(aes(fill = milex_class, x = count)) + 
  geom_histogram(alpha = 0.6, binwidth = 3, position = "dodge") +
  labs(
    title = "Distribution of Incident Counts", 
    subtitle = "Grouped by higher than median military expenditure or lower than median military expenditure", 
    y = "Number of Observations", 
    x = "Incident Counts (thousands)",
    fill = "Military Expenditure Class (relative to median)"
  ) +
  coord_cartesian(xlim = c(0, 30)) + 
  theme_minimal() +
  theme(legend.position = "bottom")

```

### Visualization for Iron and Steel Production
Grouping countries by "high" and "low" iron/steel production examines the link between industrial capacity and incident frequency.

In order to determine: 
Do countries with high production experience more conflicts due to their industrial capabilities being militarized?

Are countries with low production capacity less involved in conflicts due to industrial limitations?
@fig-visual-irst-class demonstrates that *** connection to hypothesis 

```{r}
#| label: fig-visual-irst-class
#| echo: false
#| fig-cap: "Distribution of conflicts for countries with different industrial power/production"

asia |>
  ggplot(aes(fill = irst_class, x = count)) + 
  geom_histogram(alpha = 0.6, binwidth = 3, position = "dodge") +
  labs(
    title = "Distribution of Incident Counts", 
    subtitle = "Grouped by higher or lower than median iron and steel production", 
    y = "Number of Observations", 
    x = "Incident Counts (thousands)",
    fill = "Iron and Steel Production Class (relative to median)"
  ) +
  coord_cartesian(xlim = c(0, 30)) + 
  theme_minimal() +
  theme(legend.position = "bottom")

```

# Results - Hypothesis Exploration

In order to directly test our hypothesis regarding whether high military capabilities correlate with higher conflict frequencies we decided to include a bootstrap histogram. The graph helps validates whether differences in conflict frequency are significant or due to random variation. 

The bootstrap test evaluates whether the difference in the mean conflict frequency (count) between countries with differnent military capablities, is significant.

If the Mean Difference is Consistently Positive: This suggests that countries with higher military capablities are associated with higher conflict frequencies. This would support a hypothesis suggesting a positive correlation between military expenditures and conflict involvement.

If the Mean Difference is Near Zero or Negative: This implies little to no difference or a negative association, which could contradict the hypothesis.

## Bootstrap Test for Military expenditure and Conflict Frequency 

@fig-explorea demonstrates that the distribution of bootstrapped differences is centered around a positive value, approximately 2.5.

This suggests that, on average, countries with higher military expenditures are associated with higher conflict frequencies. 

The histogram's shape, with a clear peak and most values concentrated in a narrow range between 1 and 3.5, supports this postive relationship.

This suggests that countries with higher military expenditures are associated with higher conflict frequencies. This finding supports the hypothesis suggesting a positive correlation suggesting that countries with higher military expenditures are more likely to participate in armed conflicts. However, this value, due to its size, is moderate. Its a moderate positive correlation.


```{r}
#| label: fig-explorea
#| fig-cap: "Bootstrap Test for Military expenditure and Conflict Frequency"
#| message: false
#| warning: false


#milex: Military expenditure.
#milper: Military personnel
#irst: Iron and Steel production

set.seed(44) 

# # high vs. low military expenditure
# threshold <- median(asia$milex, na.rm = TRUE) 
# #  median as a threshold as it rovides a more accurate threshold by representing the central tendency of the data
# asia <- asia |>
#   mutate(milex_level = ifelse(milex > threshold, "High", "Low"))

bootstrap_means <- replicate(1000, {
  sampled_data <- asia |>
    sample_frac(replace = TRUE) 
  # Resample with replacement
  
  means <- sampled_data |>
    group_by(milex_class) |>
    summarize(mean_count = mean(count, na.rm = TRUE))
  
  -diff(means$mean_count) # diff in mean conflict frequency between High and Low `milex`
})

bootstrap_df <- tibble(boot_diff = bootstrap_means)
ggplot(bootstrap_df, aes(x = boot_diff)) +
  geom_histogram(binwidth = 0.5, fill = "steelblue", color = "white") +
  labs(
    title = "Do High Military Expenditures Correlate with Conflict Frequency?",
    x = "Military Expenditure (milex)",
    y = "Average Number of Armed Conflicts"
  ) + 
  theme_minimal()

```

## Bootstrap Test for Iron Production and Conflict Frequency 

@fig-exploreb demonstrates that the distribution of bootstrapped differences is centered around a positive value, approximately 1.75.

This suggests that, on average, countries with higher military expenditures are associated with higher conflict frequencies. 

The histogram's shape, with a clear peak and most values concentrated in a narrow range between 1 and 3, supports this postive relationship.

This suggests that countries with higher military expenditures are associated with higher conflict frequencies. This finding supports the hypothesis suggesting a positive correlation suggesting that countries with higher military expenditures are more likely to participate in armed conflicts. However, this value, due to its size, is moderate. Its a moderate positive correlation. 

```{r}
#| label: fig-exploreb
#| fig-cap: "Bootstrap Test for Iron Production and Conflict Frequency "
#| message: false
#| warning: false

set.seed(44) 

#irst: Iron and Steel production


#Military personnel
threshold <- median(asia$irst, na.rm = TRUE) 
#  median as a threshold as it rovides a more accurate threshold by representing the central tendency of the data

bootstrap_medians <- replicate(1000, {
  sampled_data <- asia |>
    sample_frac(replace = TRUE) 
  # Resample with replacement
  
  medians <- sampled_data |>
    group_by(irst_class) |>
    summarize(median_count = median(count, na.rm = TRUE))
  
  -diff(medians$median_count) # diff in mean conflict frequency between High and Low `milex`
})

bootstrap_df <- tibble(boot_diff = bootstrap_medians)
ggplot(bootstrap_df, aes(x = boot_diff)) +
  geom_histogram(binwidth = 0.0001, fill = "steelblue", color = "white") +
  labs(
    title = "Does High Iron and Steel Production Correlate with Conflict Frequency?",
    x = "Iron and Steel Production (irst)",
    y = "Average Number of Armed Conflicts"
  ) + 
  theme_minimal()
```

## Hypothesis Test 
The shows ***, supports our hypothesis 

$$
Null~H_{0}: μ_{lorem} = μ_{lorem}: no
$$

$$
Alternative~H_{A}: μ_{lorem} ≠ μ_{lorem}: yes
$$



```{r}
#| label: hypothesis-testing-milex
asia_hypothesis <- asia
set.seed(44)

null_distribution_milex <- asia_hypothesis |>
  specify(response = count, explanatory = milex_class) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("high", "low"))

observed_median_milex <- asia_hypothesis |>
  specify(response = count, explanatory = milex_class) |>
  calculate(stat = "diff in medians", order = c("high", "low")) |>
  pull(stat)

null_distribution_milex |>
  get_p_value(obs_stat = observed_median_milex, direction = "two-sided") |>
  rename("p-value of milex" = "p_value") |>
  knitr::kable() |>
  kable_styling(full_width = FALSE, position = "left", bootstrap_options = c("striped", "hover", "condensed"))

null_distribution_milex |>
  get_confidence_interval()  |>
  rename("lower_ci of milex" = "lower_ci", "upper_ci of milex" = "upper_ci") |>
  knitr::kable() |> 
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"))

null_distribution_irst <- asia_hypothesis |>
  specify(response = count, explanatory = irst_class) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("high", "low"))

observed_median_irst <- asia_hypothesis |>
  specify(response = count, explanatory = irst_class) |>
  calculate(stat = "diff in medians", order = c("high", "low")) |>
  pull(stat)

null_distribution_irst |>
  get_p_value(obs_stat = observed_median_irst, direction = "two-sided") |>
  rename("p-value of irst" = "p_value") |>
  knitr::kable() |>
  kable_styling(full_width = FALSE, position = "left", bootstrap_options = c("striped", "hover", "condensed"))


null_distribution_irst |>
  get_confidence_interval() |>
  rename("lower_ci of irst" = "lower_ci", "upper_ci of irst" = "upper_ci") |>
  knitr::kable() |> 
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"))
```


@tbl-countries-conflict-iron-model shows ***, supports our hypothesis 

```{r}
#| label: tbl-countries-conflict-iron-model
#| tbl-cap: "Linear Regression Model for Conflict and Military Capablites"
#| message: false
#| warning: false

country_conflict_incident_model <- linear_reg() |>
  fit(count ~ milex + milper + irst + cinc, data = asia)

tidy(country_conflict_incident_model) |> 
kable(digits = 4)

```

@tbl-log-disp-asia shows ***, supports our hypothesis 


```{r}
#| label: tbl-log-disp-asia 
#| tbl-cap: "Logistic Regression Model for more than 50 disputes in Asia"


country_join_continents |>
  summarize(mean = mean(count))

  
  asia_log_raw <- country_join_continents |>
  mutate(
    disp_above_50 = if_else(count >= 50, "yes", "no"),
    disp_above_50 = fct_relevel(disp_above_50, "yes", "no")
  ) |>
  filter(Continent == "Asia")

asia_fit <- logistic_reg() |>
  fit(disp_above_50 ~ irst + milex + milper, data = asia_log_raw)

tidy(asia_fit) |>
kable(digits = 4)

```

$$
\widehat{disp~above~50} = 5.077 - (1.353 * 10^{-6}) * irst - (2.528 * 10^{-9}) * milex - (6.643 * 10^{-6}) * milper
$$