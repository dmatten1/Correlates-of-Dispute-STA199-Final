---
title: Influence of National Resources on Country Conflict
subtitle: Report
execute:
  echo: true
---

AT THE END --\> set echo to false to not display the code cells ; only plots, words, and messages; cite gpt in code cells\
DOI citations or manually write refernces and citations \> not a requirement

This study examines the relationship between a country's national material capabilities — such as military expenditures, personnel, and iron — and its frequency engaging in conflict.
By analyzing data from the Correlates of War project, which tracks national capabilities and militarized interstate disputes, this research aims to identify whether increases in these capabilities correlate with higher frequencies of interstate conflict.
The findings seek to enhance our understanding of how shifts in state power influence international stability and conflict dynamics.

## Introduction and data

Our research question is as follows: how do changes in national material capabilities influence the frequency of a country's conflicts, focusing on the continent of Asia?
We hypothesize that countries with higher military expenditures and personnel are more likely to participate in armed conflicts.
The primary motivation for this research is to explore the relationship between national material capabilities and a country’s likelihood of being involved in conflicts.
Understanding how changes in a nation’s military capabilities — such as military expenditures and natural resources like iron — affect its involvement in international disputes is important for assessing political stability.

This research aligns with a broader theme of examining how data can explain political dynamics, provide insights into state behavior, and potentially help predict future conflicts.
In analyzing the intersection of politics and data, this study aims to tell a story about how power, in its different forms, shapes international relations.

The data used in this analysis comes from the Correlates of War (COW) project, which is widely used by political scientists.
This project consists of two datasets that apply to our research:

**National Material Capabilities** (Dataset 1): This dataset includes data on military power indicators such as military expenditures, military personnel, energy consumption, and total population for various countries.
The data is collected annually, providing a comprehensive look at the material capabilities of each nation over time.

**Militarized Interstate Disputes** (Dataset 2): This dataset records instances where states threaten, display, or use force against one another.
The data includes details such as the start and end dates of conflicts, number of combatants, casualties, and the outcomes of these disputes.
This dataset spans from 1816 to 2014 and provides insight into the frequency and intensity of conflicts between countries.

## Methodology

Our project explored the relationship between military conflicts and various factors, including military expenditure, personnel, iron and steel production, and national capabilities.
Given the extensive dataset, which covered numerous countries, we initially faced challenges regarding clarity.
To streamline our analysis, we narrowed the scope to Asia, which emerged as the continent with the highest conflict frequency during our initial exploration.

In preparing the data, we addressed several challenges.
Variables irrelevant to our analysis were removed, and we were forced to correct unique country codes that didn’t align with standard naming conventions.
These codes were manually mapped to their respective countries, and we classified nations by continent, allowing us to focus solely on Asia.

Using this cleaned dataframe, we created visualizations to identify patterns in conflict frequency, iron production, and military strength metrics.
For example, we examined the periods with the highest levels of conflict and iron production and determined which countries contributed most to these metrics.
Early visualizations were cluttered due to the large number of countries, so we filtered the data to focus on the top 15 countries in terms of conflict frequency and iron production to improve clarity.
We also investigated correlations between national capabilities, such as military expenditure and conflict frequency, to identify potential predictors.
To assess the impact of these variables, we used regression modeling, with predictor variables.

For our analysis, we utilized several key R libraries to streamline data manipulation, modeling, and visualization.
The tidyverse suite was useful in providing tools for filtering and summarizing data and ggplot for crafting visualizations.
We used readxl to import Excel datasets into R.
The countrycode package helped map country codes from the dataset to their corresponding country names, helping us to group data by continent and eventually determine the focus on Asian countries.
For modeling and diagnostics, we relied on tidymodels for regression analysis.

Combining data preparation, visualization, statistical analysis, and modeling, we found meaningful trends and relationships that highlight how national capabilities influence military conflicts different countries in Asia.
This comprehensive approach allowed us to derive insights into the multifaceted drivers of geopolitics.

## Results

This is where you will discuss your overall finding and describe the key results from your analysis.
The goal is not to interpret every single element of an output shown, but instead to address the research questions, using the interpretations to support your conclusions.
Focus on the variables that help you answer the research question and that provide relevant context for the reader.

## Discussion

In this section you’ll include a summary of what you have learned about your research question along with statistical arguments supporting your conclusions.
In addition, discuss the limitations of your analysis and provide suggestions on ways the analysis could be improved.
Any potential issues pertaining to the reliability and validity of your data and appropriateness of the statistical analysis should also be discussed here.
Lastly, this section will include ideas for future work.

# Data Exploration

```{r}
#| label: load-pkgs
#| message: false
library(tidyverse)
library(readxl)
library(countrycode) 
library(tidymodels)
library(openintro)
library(ggcorrplot)
library(broom)
library(kableExtra)

#main dataset abt resources

country_resource <- read_csv("data/NMC.csv")

#main dataset abt conflict

country_conflict <- read_csv("data/Conflict.csv")

```

# Cleaning Data

```{r}
#| label: join-datasets

country_resource <- country_resource |>
  select(-ccode, -version)

country_conflict <- country_conflict |>
  select(-ccode, -version)
```

```{r}
country_join <- country_conflict |>
  full_join(country_resource, by = join_by(
      stabb == stateabb, 
      styear == year
    )
  )

number_of_disputes_df <- country_join |>
  group_by(stabb, styear) |>
  summarize(count = n(), .groups = "drop")


```

```{r}
country_join_edit <- country_join |>
  left_join(number_of_disputes_df, by = c("stabb" = "stabb", "styear" = "styear"))

country_join_edit <- country_join |>
  left_join(number_of_disputes_df, by = c("stabb" = "stabb", "styear" = "styear"))

country_join_shorter <- country_join_edit |>
  select(stabb, styear, count, milex, milper, irst, cinc) |>
  distinct() |>
  filter(styear>1950)
```

# Adding Continents

```{r}
#| label: continents 
#| message: false
#| warning: false

# Manually addded countried from the COW dataset, COW codes do not match universal country codes so there were many NAs using the country code package to use the continents 

# cow code to country name --> to actual ISO code --> continents 

#stabb_values <- country_join_edit[["stabb"]] isolating COW code
#unique_stabb_values <- unique(stabb_values) removing duplicates; 219 countries unique 



CountryName <- data.frame(
  COWn = c("ZIM", "ZAN", "ZAM", "YUG", "YPR", "YEM", "YAR", "WSM", "WRT", "VEN", "VAN", 
           "UZB", "USA", "URU", "UKR", "UKG", "UGA", "UAE", "TUV", "TUS", "TUR", "TUN", "TRI", 
           "TON", "TOG", "TKM", "THI", "TAZ", "TAW", "TAJ", "SYR", "SWZ", "SWD", "SWA", "SVG", 
           "SUR", "SUD", "STP", "SSD", "SRI", "SPN", "SOM", "SOL", "SNM", "SLV", "SLU", "SLO", 
           "SKN", "SIN", "SIE", "SIC", "SEY", "SEN", "SAX", "SAU", "SAL", "SAF", "RWA", "RVN", 
           "RUS", "ROM", "ROK", "QAT", "PRK", "POR", "POL", "PNG", "PMA", "PHI", "PER", "PAR", 
           "PAP", "PAN", "PAL", "PAK", "OMA", "NTH", "NOR", "NIR", "NIG", "NIC", "NEW", "NEP", 
           "NAU", "NAM", "MZM", "MYA", "MSI", "MOR", "MON", "MOD", "MNG", "MNC", "MLT", "MLI", 
           "MLD", "MEX", "MEC", "MAW", "MAS", "MAL", "MAG", "MAD", "MAC", "MAA", "LUX", "LIT", 
           "LIE", "LIB", "LES", "LEB", "LBR", "LAT", "LAO", "KZK", "KYR", "KUW", "KOS", "KOR", 
           "KIR", "KEN", "JPN", "JOR", "JAM", "ITA", "ISR", "IRQ", "IRN", "IRE", "INS", "IND", 
           "ICE", "HUN", "HSG", "HSE", "HON", "HKG", "HAN", "HAI", "GUY", "GUI", "GUA", "GRN", 
           "GRG", "GRC", "GNB", "GMY", "GHA", "GFR", "GDR", "GAM", "GAB", "FSM", "FRN", "FIN", 
           "FIJ", "EU", "ETM", "ETH", "EST", "ERI", "EQG", "EGY", "ECU", "DRV", "DRC", "DOM", 
           "DMA", "DJI", "DEN", "CZR", "CZE", "CYP", "CUB", "CRO", "COS", "CON", "COM", "COL", 
           "CHN", "CHL", "CHA", "CEN", "CDI", "CAP", "CAO", "CAN", "CAM", "BUL", "BUI", "BRU", 
           "BRA", "BOT", "BOS", "BOL", "BNG", "BLZ", "BLR", "BHU", "BHM", "BFO", "BEN", "BEL", 
           "BAV", "BAR", "BAH", "BAD", "AZE", "AUS", "AUL", "AUH", "ARM", "ARG", "ANG", "AND", 
           "ALG", "ALB", "AFG"),
  Country = c("Zimbabwe", "Zanzibar", "Zambia", "Yugoslavia/Serbia", "Yemen People's Republic", 
              "Yemen", "Yemen Arab Republic", "Samoa", "Wuerttemburg", "Venezuela", "Vanuatu", 
              "Uzbekistan", "United States of America", "Uruguay", "Ukraine", "United Kingdom", 
              "Uganda", "United Arab Emirates", "Tuvalu", "Tuscany", "Turkey", "Tunisia", 
              "Trinidad and Tobago", "Tonga", "Togo", "Turkmenistan", "Thailand", "Tanzania", 
              "Taiwan", "Tajikistan", "Syria", "Switzerland", "Sweden", "Swaziland", 
              "St. Vincent and the Grenadines", "Suriname", "Sudan", "Sao Tome and Principe", 
              "South Sudan", "Sri Lanka", "Spain", "Somalia", "Solomon Islands", "San Marino", 
              "Slovenia", "St. Lucia", "Slovakia", "St. Kitts and Nevis", "Singapore", 
              "Sierra Leone", "Two Sicilies", "Seychelles", "Senegal", "Saxony", "Saudi Arabia", 
              "El Salvador", "South Africa", "Rwanda", "Republic of Vietnam", "Russia", "Romania", 
              "South Korea", "Qatar", "North Korea", "Portugal", "Poland", "Papua New Guinea", 
              "Parma", "Philippines", "Peru", "Paraguay", "Papal States", "Panama", "Palau", 
              "Pakistan", "Oman", "Netherlands", "Norway", "Niger", "Nigeria", "Nicaragua", 
              "New Zealand", "Nepal", "Nauru", "Namibia", "Mozambique", "Myanmar", "Marshall Islands", 
              "Morocco", "Mongolia", "Modena", "Montenegro", "Monaco", "Malta", "Mali", "Moldova", 
              "Mexico", "Mecklenburg Schwerin", "Malawi", "Mauritius", "Malaysia", "Madagascar", 
              "Maldives", "Macedonia", "Mauritania", "Luxembourg", "Lithuania", "Liechtenstein", 
              "Libya", "Lesotho", "Lebanon", "Liberia", "Latvia", "Laos", "Kazakhstan", 
              "Kyrgyzstan", "Kuwait", "Kosovo", "Korea", "Kiribati", "Kenya", "Japan", "Jordan", 
              "Jamaica", "Italy", "Israel", "Iraq", "Iran", "Ireland", "Indonesia", "India", "Iceland", 
              "Hungary", "Hesse Grand Ducal", "Hesse Electoral", "Honduras", "Hong Kong", 
              "Hanover", "Haiti", "Guyana", "Guinea", "Guatemala", "Grenada", "Georgia", "Greece", 
              "Guinea-Bissau", "Germany", "Ghana", "German Federal Republic", "German Democratic Republic", 
              "Gambia", "Gabon", "Federated States of Micronesia", "France", "Finland", "Fiji", 
              "European Community/Union", "East Timor", "Ethiopia", "Estonia", "Eritrea", "Equatorial Guinea", 
              "Egypt", "Ecuador", "Vietnam", "Democratic Republic of the Congo", "Dominican Republic", 
              "Dominica", "Djibouti", "Denmark", "Czech Republic", "Czechoslovakia", "Cyprus", "Cuba", 
              "Croatia", "Costa Rica", "Congo", "Comoros", "Colombia", "China", "Chile", "Chad", 
              "Central African Republic", "Ivory Coast", "Cape Verde", "Cameroon", "Canada", "Cambodia", 
              "Bulgaria", "Burundi", "Brunei", "Brazil", "Botswana", "Bosnia and Herzegovina", "Bolivia", 
              "Bangladesh", "Belize", "Belarus", "Bhutan", "Bahamas", "Burkina Faso", "Benin", "Belgium", 
              "Bavaria", "Barbados", "Bahrain", "Baden", "Azerbaijan", "Austria", "Australia", "Austria-Hungary", 
              "Armenia", "Argentina", "Angola", "Andorra", "Algeria", "Albania", "Afghanistan")
)

country_join_countrynames <- country_join_shorter |>
  left_join(CountryName, by = c("stabb" = "COWn")) 


# country column to get the ISO codes and continents
country_join_continents <- country_join_countrynames |>
  mutate(
    # join for country code conversion
    Country_code = countrycode(Country, "country.name", "iso3c"),
    # convert the ISO country code to continent
    Continent = countrycode(Country_code, "iso3c", "continent")
  ) |>
  filter(!is.na(Country)) |>
  filter(!is.na(Continent))
country_join_continents


```

# Iron

This scatterplot shows the relationship between iron and steel production (in thousands of tons) and the incident count across countries, categorized by continent.
The data suggests that most countries with low iron and steel production have a wide range of incident counts, while countries with high production tend to have fewer incidents, concentrated at lower counts.
Notably, Asia and Europe dominate the high-production range, while other continents exhibit more dispersed patterns in lower production ranges.

```{r}
#| label: graph-Iron-and-IncidentCount
#| message: false
#| warning: false
ggplot(country_join_continents, aes(x = irst, y = count, color = Continent)) +
  geom_point(alpha = 0.4) + 
   labs(title = "Iron and steel production (thousands of tons) vs Incident Count by Country",
       x = "Iron and steel production (thousands of tons)",
       y = "Count") +
  theme_minimal()

```

# Which Continent has the Highest Propensity for Conflict?

This bar plot shows that the continent with the highest propensity for conflict is Asia.

```{r}
#| label: high-prop-conflict 
#| message: false
#| warning: false

conflict_by_continent <- country_join_continents |>
  group_by(Continent) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  arrange(desc(total_conflict))


conflict_by_continent |>
  ggplot(aes(x = reorder(Continent, -total_conflict), y = total_conflict, fill = Continent)) +
  geom_col() +
  labs(
    title = "Total Conflict Incidents by Continent",
    x = "Continent",
    y = "Total Conflict Incidents",
    fill = "Continent"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Blues") #make it pretty 
```

Focus on the continent with the highest propensity for conflict, which is Asia.

```{r}
#| label: period-conflicts
#| message: false
#| warning: false
#| layout-ncol: 2

#fliter by asia 
asia <- country_join_continents |>
  filter(Continent == "Asia")


asia |>
  group_by(styear) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  ggplot(aes(x = styear, y = total_conflict)) +
  geom_line() +
  labs(
    title = "Trends in Conflict Incidents in Asia",
    x = "Year",
    y = "Total Conflict Incidents"
  ) +
  theme_minimal()


#fliter by asia 
asia <- country_join_continents |>
  filter(Continent == "Asia")

asia <- asia |>
  group_by(Country) |>
  mutate(
    mean_milex = mean(milex),
    mean_irst = mean(irst)
  )
# Confict and Iron production start around the same years.

asia |>
  group_by(styear) |>
  summarize(total_iron_production = sum(irst, na.rm = TRUE)) |>
  ggplot(aes(x = styear, y = total_iron_production)) +
  geom_line() +
  labs(
    title = "Trends in Iron and steel production (thousands of tons) in Asia",
    x = "Year",
    y = "Total Conflict Incidents around the same years as conflict"
  ) +
  theme_minimal()


```

# Exploration focusing on Asian Countries

## Correlation between National Material Capabilities and Total Incident Counts

```{r}
#| label: correlation-matrix 
#| message: false
#| warning: false
#| layout-ncol: 3

#milex: Military expenditure.
#milper: Military personnel
#irst: Iron and Steel production
#cinc: Composite Index of National Capability.
#count: Frequency of conflicts.

asia <- asia |>
  mutate(count = as.numeric(count)) |>
  filter(!is.na(count)) |>
  ungroup()

asia |>
  select(milex, milper, irst, cinc, count) |>
  cor(use = "complete.obs")
# calc correlations; no missing val accounted 

selected_vars <- asia |>
  select(count, milex, milper, irst, cinc)

cor_matrix <- cor(selected_vars, use = "pairwise.complete.obs")

ggcorrplot(cor_matrix, 
           method = "circle", 
           type = "lower", 
           lab = TRUE, 
           title = "Correlation of Material Capabilities and Conflict Frequency")

# Hypothesis Testing: Correlation significance
# cor_test_results <- map_df(
#   c("milex", "milper", "irst", "cinc"),
#   ~ tidy(cor.test(asia_15$count, asia_15[[.x]], use = "pairwise.complete.obs")),
#   .id = "variable"
# )

# cor_test_results
 

#Source: Chatgpt Q:"How to visualize correlation between different variables?"
```

## Correlation specifically between Total Incident Counts and Material Capabilities

```{r}
#| label: cor-table 

asia_cor_table <- tibble(
  `Military Capability` = c("Military Expenditures (thousands)", "Military Personnel (thousands)", "Iron and Steel Production (thousands of tons)"),
  `Correlation To Incident Count` = c(cor(asia$count, asia$milex), cor(asia$count, asia$milper), cor(asia$count, asia$irst))
)

asia_cor_table |>
  knitr::kable() |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

## Visualizations for Iron Production and Military Expenditures in Asia

a\.
Total Incident Count vs. Military Expenditures

```{r}
#| label: military-expenditure-asia 

asia |>
  ggplot(aes(x = milex, y = count)) + 
  geom_point() + 
  geom_smooth(method = "lm") + 
  labs(
    title = "Total Incident Count vs. Military Expenditures",
    subtitle = "In Asian Countries from 1951 to 2016",
    x = "Military Expenditures (thousands)", 
    y = "Total Incident Count"
  )
```

b\.
Total Incident Count vs. Iron Production

```{r}
#| label: iron-production-asia 

asia |>
  ggplot(aes(x = irst, y = count)) + 
  geom_point() + 
  geom_smooth(method = "lm") + 
  labs(
    title = "Total Incident Count vs. Iron and Steel Production",
    subtitle = "In Asian Countries from 1951 to 2016",
    x = "Iron and Steel Production (thousands of tons)", 
    y = "Total Incident Count"
  )
```
## Classifying Asian Countries by Military Expenditures and Iron + Steel Production 

```{r}
#| label: mutate-data 

asia <- asia |> 
  mutate(
    milex_class = case_when(
      milex < quantile(milex, 0.25, na.rm = TRUE) ~ "low",
      milex > quantile(milex, 0.75, na.rm = TRUE) ~ "high",
      .default = "medium"
    ),
    
    irst_class = case_when(
      irst < quantile(irst, 0.25, na.rm = TRUE) ~ "low",
      irst > quantile(irst, 0.75, na.rm = TRUE) ~ "high",
      .default = "medium"
  )
)
```

## Visualization of Iron + Steel Production and Military Expenditure Classes

```{r}
#| label: visual-irst-class

asia |>
  group_by(milex_class)
  ggplot(
    aes(y = )
  )
```







Countries in Asia that lead in Incident Count and Iron Production

```{r}
#| label: top-countries-conflict-irona
#| message: false
#| warning: false
#| layout-ncol: 2

top_15_countries_in_asia <- asia |>
  group_by(stabb) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  arrange(desc(total_conflict)) |>
  head(15) |>
  pull(stabb)
asia_15 <- asia |>
  filter(stabb %in% top_15_countries_in_asia)

low_15_countries_in_asia <- asia |>
  group_by(stabb) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  arrange(total_conflict) |>
  head(15) |>
  pull(stabb)
asia_low_15 <- asia |>
  filter(stabb %in% low_15_countries_in_asia)

#asia_15 |>
  #group_by(stabb) |>
  #summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  #arrange(desc(total_conflict))


asia_15 |>
  group_by(stabb) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  ggplot(aes(x = reorder(stabb, -total_conflict), y = total_conflict)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Conflict Incidents by Country in Asia",
    x = "Country",
    y = "Total Conflict Incidents"
  ) +
  theme_minimal()
#asia_15 |>
  #group_by(stabb) |>
  #summarize(total_iron_production = sum(irst, na.rm = TRUE)) |>
  #arrange(desc(total_iron_production))

asia_15 |>
  group_by(stabb) |>
  summarize(total_iron_production = sum(irst, na.rm = TRUE)) |>
  ggplot(aes(x = reorder(stabb, -total_iron_production), y = total_iron_production)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Iron Production by Country in Asia",
    x = "Country",
    y = "Total Iron Production"
  ) +
  theme_minimal()
```

Countries in Asia that lead in Incident Count and Military expenditure (Milper).

```{r}
#| label: top-countries-conflict-ironb
#| message: false
#| warning: false
#| layout-ncol: 2

top_15_countries_in_asia <- asia |>
  group_by(stabb) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  arrange(desc(total_conflict)) |>
  head(15) |>
  pull(stabb)
asia_15 <- asia |>
  filter(stabb %in% top_15_countries_in_asia)

low_15_countries_in_asia <- asia |>
  group_by(stabb) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  arrange(total_conflict) |>
  head(15) |>
  pull(stabb)
asia_low_15 <- asia |>
  filter(stabb %in% low_15_countries_in_asia)

#asia_15 |>
  #group_by(stabb) |>
  #summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  #arrange(desc(total_conflict))


asia_15 |>
  group_by(stabb) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  ggplot(aes(x = reorder(stabb, -total_conflict), y = total_conflict)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Conflict Incidents by Country in Asia",
    x = "Country",
    y = "Total Conflict Incidents"
  ) +
  theme_minimal()


#asia_15 |>
  #group_by(stabb) |>
  #summarize(total_iron_production = sum(irst, na.rm = TRUE)) |>
  #arrange(desc(total_iron_production))

asia_15 |>
  group_by(stabb) |>
  summarize(total_milex = sum(milex, na.rm = TRUE)) |>
  ggplot(aes(x = reorder(stabb, -total_milex), y = total_milex)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Military Expenditure by Country in Asia",
    x = "Country",
    y = "Total Military Expenditure"
  ) +
  theme_minimal()


```

Countries in Asia that lead in Incident Count and Military personnel (milper).

```{r}
#| label: top-countries-conflict-iron
#| message: false
#| warning: false
#| layout-ncol: 2

top_15_countries_in_asia <- asia |>
  group_by(stabb) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  arrange(desc(total_conflict)) |>
  head(15) |>
  pull(stabb)
asia_15 <- asia |>
  filter(stabb %in% top_15_countries_in_asia)

low_15_countries_in_asia <- asia |>
  group_by(stabb) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  arrange(total_conflict) |>
  head(15) |>
  pull(stabb)
asia_low_15 <- asia |>
  filter(stabb %in% low_15_countries_in_asia)

#asia_15 |>
  #group_by(stabb) |>
  #summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  #arrange(desc(total_conflict))


asia_15 |>
  group_by(stabb) |>
  summarize(total_conflict = sum(count, na.rm = TRUE)) |>
  ggplot(aes(x = reorder(stabb, -total_conflict), y = total_conflict)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Conflict Incidents by Country in Asia",
    x = "Country",
    y = "Total Conflict Incidents"
  ) +
  theme_minimal()


#asia_15 |>
  #group_by(stabb) |>
  #summarize(total_iron_production = sum(irst, na.rm = TRUE)) |>
  #arrange(desc(total_iron_production))

asia_15 |>
  group_by(stabb) |>
  summarize(total_milper = sum(milper, na.rm = TRUE)) |>
  ggplot(aes(x = reorder(stabb, -total_milper), y = total_milper)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Military Personnel by Country in Asia",
    x = "Country",
    y = "Total Military Personnel"
  ) +
  theme_minimal()


```

```{r}
#| label: top-low-countries
top_5_countries_asia <- asia_15 |>
  group_by(Country) |>
  summarize(
    total_count = sum(count),
    total_irst = sum(irst),
    total_milper = sum(milper),
    total_milex = sum(milex)
  ) |>
  arrange(desc(total_count)) |>
  head(5)

top_5_countries_asia

low_5_countries_asia <- asia_low_15 |>
  group_by(Country) |>
  summarize(
    total_count = sum(count),
    total_irst = sum(irst),
    total_milper = sum(milper),
    total_milex = sum(milex)
  ) |>
  arrange(total_count) |>
  head(5)

low_5_countries_asia
```

# Explore

Relations between material capabilities and conflict frequency.

The hypothesis was that countries with higher military expenditures and personnel are more likely to participate in armed conflicts.

The hypothesis was that countries with higher military expenditures and personnel are more likely to participate in more armed conflicts.

The findings partially support the hypothesis.
While military expenditure and industrial production (iron) are associated with increased conflict frequency, other indicators such as personnel size and composite capabilities exhibit weaker or insignificant relationships.
This suggests that while certain aspects of military strength contribute to conflicts, not all necessarily result in more conflict in this dataset.

```{r}
#| label: top-countries-conflict-iron-cor
#milex: Military expenditure.
#milper: Military personnel
#irst: Iron and Steel production
#cinc: Composite Index of National Capability.
#count: Frequency of conflicts.

asia <- asia |>
  mutate(count = as.numeric(count)) |>
  ungroup()

asia |>
  select(milex, milper, irst, cinc, count) |>
  cor(use = "complete.obs")
# calc correlations; no missing val accounted 
```

While the data partially supports the hypothesis, the findings indicate that military expenditure is a stronger predictor of conflict frequency than personnel size or other capabilities.
This suggests that conflicts may be more directly influenced by how resources are utilized (expenditure) rather than the sheer magnitude of military capabilities (personnel size or iron).

```{r}
#| label: coranalysus
#| message: false
#| warning: false
#| layout-ncol: 3

#milex: Military expenditure.
#milper: Military personnel
#irst: Iron and Steel production
#cinc: Composite Index of National Capability.
#count: Frequency of conflicts.


asia |>
  select(milex, milper, irst, cinc, count) |>
  cor(use = "complete.obs")
# calc correlations; no missing val accounted 

selected_vars <- asia |>
  select(count, milex, milper, irst, cinc)

cor_matrix <- cor(selected_vars, use = "pairwise.complete.obs")

ggcorrplot(cor_matrix, 
           method = "circle", 
           type = "lower", 
           lab = TRUE, 
           title = "Correlation of Material Capabilities and Conflict Frequency")

# Hypothesis Testing: Correlation significance
cor_test_results <- map_df(
  c("milex", "milper", "irst", "cinc"),
  ~ tidy(cor.test(asia_15$count, asia_15[[.x]], use = "pairwise.complete.obs")),
  .id = "variable"
)

cor_test_results
 

#Source: Chatgpt Q:"How to visualize correlation between different variables?"
```

The distribution of bootstrapped differences is centered around a negative value, approximately -3.
This suggests that, on average, countries with higher military expenditures experience fewer conflicts than those with lower expenditures.
The histogram's shape, with a clear peak and most values concentrated in a narrow range between -4 and -2, supports this negative relationship.

This finding contradicts the hypothesis that countries with higher military expenditures and personnel are more likely to participate in armed conflicts.
Instead, the analysis suggests that higher military expenditures might correlate with fewer conflicts, potentially acting as a deterrent.

```{r}
#| label: explorea
#| message: false
#| warning: false

set.seed(44) 

# high vs. low military expenditure
threshold <- median(asia$milex, na.rm = TRUE) 
#  median as a threshold as it rovides a more accurate threshold by representing the central tendency of the data
asia <- asia |>
  mutate(milex_level = ifelse(milex > threshold, "High", "Low"))

bootstrap_means <- replicate(1000, {
  sampled_data <- asia |>
    sample_frac(replace = TRUE) 
  # Resample with replacement
  
  means <- sampled_data |>
    group_by(milex_level) |>
    summarize(mean_count = mean(count, na.rm = TRUE))
  
  -diff(means$mean_count) # diff in mean conflict frequency between High and Low `milex`
})

bootstrap_df <- tibble(boot_diff = bootstrap_means)
ggplot(bootstrap_df, aes(x = boot_diff)) +
  geom_histogram(binwidth = 0.5, fill = "steelblue", color = "white") +
  labs(
    title = "Bootstrapped Mean Differences in Conflict Frequency (High vs Low Milex)",
    x = "Difference in Mean Conflict Frequency",
    y = "Frequency"
  ) + 
  theme_minimal()

```

```{r}
#| label: exploreb
#| message: false
#| warning: false

set.seed(44) 

#milper: Military personnel


#Military personnel
threshold <- median(asia$milper, na.rm = TRUE) 
#  median as a threshold as it rovides a more accurate threshold by representing the central tendency of the data
asia <- asia |>
  mutate(milper_level = ifelse(milper > threshold, "High", "Low"))

bootstrap_means <- replicate(1000, {
  sampled_data <- asia |>
    sample_frac(replace = TRUE) 
  # Resample with replacement
  
  means <- sampled_data |>
    group_by(milper_level) |>
    summarize(mean_count = mean(count, na.rm = TRUE))
  
  -diff(means$mean_count) # diff in mean conflict frequency between High and Low `milex`
})

bootstrap_df <- tibble(boot_diff = bootstrap_means)
ggplot(bootstrap_df, aes(x = boot_diff)) +
  geom_histogram(binwidth = 0.5, fill = "steelblue", color = "white") +
  labs(
    title = "Bootstrapped Mean Differences in Conflict Frequency (High vs Low  Military personnel)",
    x = "Difference in Mean Conflict Frequency",
    y = "Frequency"
  ) + 
  theme_minimal()

```

```{r}
#| label: explorec
#| message: false
#| warning: false

set.seed(44) 

#irst: Iron and Steel production


#Military personnel
threshold <- median(asia$irst, na.rm = TRUE) 
#  median as a threshold as it rovides a more accurate threshold by representing the central tendency of the data
asia <- asia |>
  mutate(irst_level = ifelse(irst > threshold, "High", "Low"))

bootstrap_means <- replicate(1000, {
  sampled_data <- asia |>
    sample_frac(replace = TRUE) 
  # Resample with replacement
  
  means <- sampled_data |>
    group_by(irst_level) |>
    summarize(mean_count = mean(count, na.rm = TRUE))
  
  -diff(means$mean_count) # diff in mean conflict frequency between High and Low `milex`
})

bootstrap_df <- tibble(boot_diff = bootstrap_means)
ggplot(bootstrap_df, aes(x = boot_diff)) +
  geom_histogram(binwidth = 0.5, fill = "steelblue", color = "white") +
  labs(
    title = "Bootstrapped Mean Differences in Conflict Frequency (High vs Low  Military personnel)",
    x = "Difference in Mean Conflict Frequency",
    y = "Frequency"
  ) + 
  theme_minimal()

```

```{r}
#| label: countries-conflict-iron-model
#| message: false
#| warning: false

country_conflict_incident_model <- linear_reg() |>
  fit(count ~ milex + milper + irst + cinc, data = asia)

tidy(country_conflict_incident_model)

```

```{r}
#| label: disp-mean
country_join_continents |>
  summarize(mean = mean(count))

```

# Logistic Regression Model for more than 50 disputes in Asia

```{r}
#| label: log-disp-asia 
asia_log_raw <- country_join_continents |>
  mutate(
    disp_above_50 = if_else(count >= 50, "yes", "no"),
    disp_above_50 = fct_relevel(disp_above_50, "yes", "no")
  ) |>
  filter(Continent == "Asia")

asia_fit <- logistic_reg() |>
  fit(disp_above_50 ~ irst + milex + milper, data = asia_log_raw)

tidy(asia_fit)
```

$$
\widehat{disp~above~50} = 5.077 - (1.353 * 10^{-6}) * irst - (2.528 * 10^{-9}) * milex - (6.643 * 10^{-6}) * milper
$$

## Visualizations for the top and lowest asian countries

a\.
iron

```{r}
#| label: 5-visual-iron 

#TIDY SPACING (we did it in one of the aes or maybe a lab recently?)
top_5_countries_asia <- top_5_countries_asia |>
  mutate(
    type = "top 5"
  )

low_5_countries_asia <- low_5_countries_asia |>
  mutate(
    type = "low 5"
  )

all_asia_countries <- low_5_countries_asia |>
  full_join(top_5_countries_asia)

all_asia_countries |> 
  ggplot(aes(x = Country, y = total_irst, fill = type)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Total Iron Production by Country", #add number of years tracked over 
    subtitle = "Top 5 and Bottom 5 Asian Countries ranked by total incident count", 
    x = "Country",
    y = "Total Iron Production"
  ) +
  theme_minimal()
```

b\.
visualization by milex

```{r}
#| label: 5-visual-milex 

all_asia_countries |> 
  ggplot(aes(x = Country, y = total_milex, fill = type)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Total Military Expenditures by Country", #add number of years tracked over 
    subtitle = "Top 5 and Bottom 5 Asian Countries ranked by total incident count", 
    x = "Country",
    y = "Military Expenditures (thousands in British Pounds/US Dollars)"
  ) +
  theme_minimal()
```

c\.
visual by milper

```{r}
#| label: 5-visual-milper

all_asia_countries |>
  ggplot(aes(x = Country, y = total_milper, fill = type)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Total Military Personnel by Country", #add number of years tracked over 
    subtitle = "Top 5 and Bottom 5 Asian Countries ranked by total incident count", 
    x = "Country",
    y = "Military Personnel (thousands)"
  ) +
  theme_minimal()
```
